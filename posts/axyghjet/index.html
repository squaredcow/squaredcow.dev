<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CRDTs for Collaborative Writing | squaredcow.dev</title><meta name=keywords content="distributed systems,CRDTs,collaborative editing,technical interview"><meta name=description content="An introduction to Conflict-Free Replicated Data Types and their application in collaborative text editing"><meta name=author content="Luis Vaca"><link rel=canonical href=https://squaredcow.dev/posts/axyghjet/><link crossorigin=anonymous href=/assets/css/stylesheet.e7a90d54180e171f329f967016bf2d5b8c4d5814531e1240533a45fe66dbdccb.css integrity="sha256-56kNVBgOFx8yn5ZwFr8tW4xNWBRTHhJAUzpF/mbb3Ms=" rel="preload stylesheet" as=style><link rel=icon href=https://squaredcow.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://squaredcow.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://squaredcow.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://squaredcow.dev/apple-touch-icon.png><link rel=mask-icon href=https://squaredcow.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://squaredcow.dev/posts/axyghjet/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://squaredcow.dev/posts/axyghjet/"><meta property="og:site_name" content="squaredcow.dev"><meta property="og:title" content="CRDTs for Collaborative Writing"><meta property="og:description" content="An introduction to Conflict-Free Replicated Data Types and their application in collaborative text editing"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-31T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-31T00:00:00+00:00"><meta property="article:tag" content="Distributed Systems"><meta property="article:tag" content="CRDTs"><meta property="article:tag" content="Collaborative Editing"><meta property="article:tag" content="Technical Interview"><meta name=twitter:card content="summary"><meta name=twitter:title content="CRDTs for Collaborative Writing"><meta name=twitter:description content="An introduction to Conflict-Free Replicated Data Types and their application in collaborative text editing"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://squaredcow.dev/posts/"},{"@type":"ListItem","position":2,"name":"CRDTs for Collaborative Writing","item":"https://squaredcow.dev/posts/axyghjet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CRDTs for Collaborative Writing","name":"CRDTs for Collaborative Writing","description":"An introduction to Conflict-Free Replicated Data Types and their application in collaborative text editing","keywords":["distributed systems","CRDTs","collaborative editing","technical interview"],"articleBody":"An introduction to Conflict-Free Replicated Data Types Init Journey and Journal These past months I’ve been helping out with technical screen interviews on the job, the regular 1-hour meeting in which the candidate is given a code challenge and must provide a decent working solution by the end of it.\nSurprisingly enough, the place I work at does not provide access to any interview platform to assess the candidate’s skills, leaving me in a tight spot. From time to time, I have to request them to open the IDE of their choice and kindly share the screen, which I found invasive and likely to reduce the formality of the process.\nNowadays, there is a wide variety of paid services online such as CoderPad, CodeInterview, HackerRank, CoderByte; To mention a few, and all of them offer robust capabilities for online interviews.\nSimilarly, on the side of free software, we have etherpad, collabedit, and Plunker. These last ones have been an experience-saver when the candidate cannot share the screen for any reason, yet, these reflect intermittent issues lke edit-lag from time to time.\nThat situation got me intrigued and oddly inspired. How do all these real-time collaborative text platforms operate? What is the engineering behind it? Which type of technical challenge do they face, and which approaches do they follow?\nThose are plenty of questions, right? Here is where I start my amateur research on this particular topic: collaborative text in distributed systems.\nCollaborative Text: How does it work? Collaborative text web applications are asynchronous, fully powered by distributed systems, and challenged by their complexity. Consistency in the operations executed by the users takes the primary seat, while they are directly affected by the latency between the nodes.\nIf two users write, update or delete the same word in the document. Which change is the right one? Is it the last one? Is it the first one? How do we handle this edit conflict?\nIn an article published in 2011 by Marc Shapiro, Nuno Preguiça, Carlos Baquero, and Marek Zawirski named “A comprehensive study of Convergent and Commutative Replicated Data Types.”1 they propose the design of shared data types capable of conflict-free eventual consistency.\nQuoting the Abstract:\nEventual consistency aims to ensure that replicas of some mutable shared object converge without foreground synchronisation. Previous approaches to eventual consistency are ad-hoc and error-prone. We study a principled approach: to base the design of shared data types on some simple formal conditions that are sufficient to guarantee eventual consistency. We call these types Convergent or Commutative Replicated Data Types (CRDTs). (2011) 1\nThe infographic below displays an understandable glimpse of eventual consistency in optimistic replications. We will need at least this explanation as our bare minimum context to keep moving forward.\na). The AP of CAP\nDiving into CRDTs To properly define a CRDT we need to look into the smaller pieces used for their construction and later elaborate on the type of operations they can execute.\nThe clay and bricks of CRDTs CRDTs build and operate with mutable and immutable data types. The immutable types are named atoms, and they hold characteristics, such as:\nTheir content determines the type, e.g., primitives. They are copiable in between processes. If two of them have the same contents, they are equal. Meanwhile, the mutable types are named objects and have different characteristics than atoms, such as:\nThey hold identity and initial state. The contents of an object, also known as payload, are conformed by any number of atoms or objects. They expose an interface that defines contractual operations on the object. They are replicable in between processes. If two objects have the same identity but are present in different processes, they are considered replicas. The operations exposed for working with objects may follow two different approaches: state-based and operation-based.\nCategories of CRDTS In state-based (passive) replication, every state-changing operation occurs at the source then the system propagates the modified payload to an arbitrary pair of replicas infinitely often. The CRDTs implementing a state-based approach are named Convergent Replicated Data Type, CvRDTs.\nMeanwhile, in operation-based (active) replication, the system transmits the state-changing operations in two phases: at-source (local) and downstream (async. in replica) one after the other, and both of them must execute atomically. The CRDTs implementing an operation-based strategy are named Commutative Replicated Data Type, CmRDTs.\nNow, let’s have a quick grasp of one of the basic CvRDTs next.\nBuilding basic CRDTs Counters The most basic of the CRDTs, a primitive that lives within the replicas exposing a set of basic operations:\nIncrement/decrement the value of the counter. Update the value of the counter. Query the value of the counter. The value of the primitive must converge towards the global number of increments minus the number of decrements. These are some of the defined CRDTs counters 1:\nGrow-only Counter (G-Counter): state-based counter for positive increments only. Positive-Negative Counter (PN-Counter): state-based counter with a double registry for positive and negative increments. Non-negative Counter: similar to PN-Counter with the restriction of not beign able to generate more decrements than the current originated increments. To provide a more thorough view of one the counters mentioned above, we picked G-Counter to further explain its operations.\nGrow-only Counter (G-Counter) G-Counter is a state-based CRDT or CvRDT for positive increments only. As mentioned above it exposes a set of basic operations: init, increment, value, merge and compare. 2\nb). G-Counter OPS: init, increment and value.\nc). G-Counter OPS: merge and compare.\nTo further visualize a GCounter, we can easily create a class named GCounter that operates with integers and implements each of the methods explained above.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 package com.squaredcow.crdts; import lombok.Data; import java.util.Arrays; @Data public final class GCounter implements Counter\u003cInteger\u003e { private Integer registryId; private Integer registrySize; private Integer[] innerRegistry; public GCounter(Integer registryId, Integer registrySize) { this.registryId = registryId; this.registrySize = registrySize; this.innerRegistry = new Integer[registrySize]; } @Override public GCounter init() { Arrays.fill(this.innerRegistry, 0); return this; } @Override public GCounter increment() { Integer id = this.registryId; this.innerRegistry[id] = this.innerRegistry[id] + 1; return this; } @Override public Integer value() { Integer result = 0; for(Integer counter : innerRegistry) { result += counter; } return result; } public Boolean compare(GCounter x, GCounter y) { for(Integer n : x.getInnerRegistry()) { if(x.getInnerRegistry()[n] \u003c= y.getInnerRegistry()[n]) { return true; } } return false; } public Integer[] merge(GCounter x, GCounter y) { Integer[] mergedRegistry = new Integer[registrySize]; for(int i = 0; i \u003c x.getInnerRegistry().length; i ++) { Integer vx = x.getInnerRegistry()[i]; Integer vy = y.getInnerRegistry()[i]; mergedRegistry[i] = Math.max(vx, vy); } return mergedRegistry; } } d). GCounter implementation in Java\nClosing words and next-steps This is an initial dive into the CRDTs structures themselves, we will eventually go deeper to construct a cluster of replicas that operate with them. We still need to go first through the rest of the structures mentioned, such as: registers, sets and graphs, but let’s have those on a second entry on this blog series.\nWith nothing left to add, thank you for reading all the way through, until next time.\n– squaredcow\nhttps://hal.inria.fr/inria-00555588/document Shapiro, Marc; Preguiça, Nuno; Baquero, Carlos; Zawirski, Marek (13 January 2011). “A Comprehensive Study of Convergent and Commutative Replicated Data Types”. Rr-7506. ↩︎ ↩︎ ↩︎\nhttps://en.wikipedia.org/wiki/Conflict-free_replicated_data_type Section: Known CRDTs ↩︎\n","wordCount":"1254","inLanguage":"en","datePublished":"2021-07-31T00:00:00Z","dateModified":"2021-07-31T00:00:00Z","author":{"@type":"Person","name":"Luis Vaca"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://squaredcow.dev/posts/axyghjet/"},"publisher":{"@type":"Organization","name":"squaredcow.dev","logo":{"@type":"ImageObject","url":"https://squaredcow.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://squaredcow.dev/ accesskey=h title="squaredcow.dev (Alt + H)">squaredcow.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://squaredcow.dev/ title=Home><span>Home</span></a></li><li><a href=https://squaredcow.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://squaredcow.dev/author/ title=About><span>About</span></a></li><li><a href=https://squaredcow.dev/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://squaredcow.dev/license/ title=License><span>License</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://squaredcow.dev/>Home</a>&nbsp;»&nbsp;<a href=https://squaredcow.dev/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">CRDTs for Collaborative Writing</h1><div class=post-description>An introduction to Conflict-Free Replicated Data Types and their application in collaborative text editing</div><div class=post-meta><span title='2021-07-31 00:00:00 +0000 UTC'>2021-07-31</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1254 words&nbsp;·&nbsp;Luis Vaca</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><ul><li><a href=#an-introduction-to-conflict-free-replicated-data-types aria-label="An introduction to Conflict-Free Replicated Data Types">An introduction to Conflict-Free Replicated Data Types</a></li></ul></ul><li><a href=#init-journey-and-journal aria-label="Init Journey and Journal">Init Journey and Journal</a></li><li><a href=#collaborative-text-how-does-it-work aria-label="Collaborative Text: How does it work?">Collaborative Text: How does it work?</a></li><li><a href=#diving-into-crdts aria-label="Diving into CRDTs">Diving into CRDTs</a><ul><li><a href=#the-clay-and-bricks-of-crdts aria-label="The clay and bricks of CRDTs">The clay and bricks of CRDTs</a></li><li><a href=#categories-of-crdts aria-label="Categories of CRDTS">Categories of CRDTS</a></li></ul></li><li><a href=#building-basic-crdts aria-label="Building basic CRDTs">Building basic CRDTs</a><ul><li><a href=#counters aria-label=Counters>Counters</a></li><li><a href=#grow-only-counter-g-counter aria-label="Grow-only Counter (G-Counter)">Grow-only Counter (G-Counter)</a></li></ul></li><li><a href=#closing-words-and-next-steps aria-label="Closing words and next-steps">Closing words and next-steps</a></li></ul></div></details></div><div class=post-content><h4 id=an-introduction-to-conflict-free-replicated-data-types>An introduction to Conflict-Free Replicated Data Types<a hidden class=anchor aria-hidden=true href=#an-introduction-to-conflict-free-replicated-data-types>#</a></h4><h2 id=init-journey-and-journal>Init Journey and Journal<a hidden class=anchor aria-hidden=true href=#init-journey-and-journal>#</a></h2><p>These past months I&rsquo;ve been helping out with technical screen interviews on the job, the regular 1-hour meeting in which the candidate is given a code challenge and must provide a decent working solution by the end of it.</p><p>Surprisingly enough, the place I work at does not provide access to any interview platform to assess the candidate&rsquo;s skills, leaving me in a tight spot. From time to time, I have to request them to open the IDE of their choice and kindly share the screen, which I found invasive and likely to reduce the formality of the process.</p><p>Nowadays, there is a wide variety of paid services online such as CoderPad, CodeInterview, HackerRank, CoderByte; To mention a few, and all of them offer robust capabilities for online interviews.</p><p>Similarly, on the side of free software, we have etherpad, collabedit, and Plunker. These last ones have been an experience-saver when the candidate cannot share the screen for any reason, yet, these reflect intermittent issues lke <strong>edit-lag</strong> from time to time.</p><p>That situation got me intrigued and oddly inspired. How do all these real-time collaborative text platforms operate? What is the engineering behind it? Which type of technical challenge do they face, and which approaches do they follow?</p><p>Those are plenty of questions, right? Here is where I start my amateur research on this particular topic: <strong>collaborative text in distributed systems</strong>.</p><h2 id=collaborative-text-how-does-it-work>Collaborative Text: How does it work?<a hidden class=anchor aria-hidden=true href=#collaborative-text-how-does-it-work>#</a></h2><p>Collaborative text web applications are asynchronous, fully powered by distributed systems, and challenged by their complexity. Consistency in the operations executed by the users takes the primary seat, while they are directly affected by the latency between the nodes.</p><p>If two users write, update or delete the same word in the document. Which change is the right one? Is it the last one? Is it the first one? How do we handle this edit conflict?</p><p>In an article published in 2011 by <em>Marc Shapiro, Nuno Preguiça, Carlos Baquero, and Marek Zawirski</em> named <strong>&ldquo;A comprehensive study of Convergent and Commutative Replicated Data Types.&rdquo;</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> they propose the design of shared data types capable of conflict-free eventual consistency.</p><p>Quoting the Abstract:</p><blockquote><p>Eventual consistency aims to ensure that replicas of some mutable shared object converge without foreground synchronisation. Previous approaches to eventual consistency are ad-hoc and error-prone. We study a principled approach: to base the design of shared data types on some simple formal conditions that are sufficient to guarantee eventual consistency. We call these types Convergent or Commutative Replicated Data Types (CRDTs). (2011) <sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>The infographic below displays an understandable glimpse of <strong>eventual consistency</strong> in <em>optimistic replications</em>. We will need at least this explanation as our bare minimum context to keep moving forward.</p><p><img alt="The AP of CAP" loading=lazy src=/images/excalidraws/the_ap_of_cap.png>
a). The AP of CAP</p><h2 id=diving-into-crdts>Diving into CRDTs<a hidden class=anchor aria-hidden=true href=#diving-into-crdts>#</a></h2><p>To properly define a CRDT we need to look into the smaller pieces used for their construction and later elaborate on the type of operations they can execute.</p><h3 id=the-clay-and-bricks-of-crdts>The clay and bricks of CRDTs<a hidden class=anchor aria-hidden=true href=#the-clay-and-bricks-of-crdts>#</a></h3><p>CRDTs build and operate with <strong>mutable</strong> and <strong>immutable</strong> data types. The immutable types are named <strong>atoms</strong>, and they hold characteristics, such as:</p><ol><li>Their content determines the type, e.g., primitives.</li><li>They are copiable in between processes.</li><li>If two of them have the same contents, they are equal.</li></ol><p>Meanwhile, the mutable types are named <strong>objects</strong> and have different characteristics than atoms, such as:</p><ol><li>They hold identity and initial state.</li><li>The contents of an object, also known as payload, are conformed by any number of atoms or objects.</li><li>They expose an interface that defines contractual operations on the object.</li><li>They are replicable in between processes.</li><li>If two objects have the same identity but are present in different processes, they are considered replicas.</li></ol><p>The operations exposed for working with objects may follow two different approaches: <strong>state-based</strong> and <strong>operation-based</strong>.</p><h3 id=categories-of-crdts>Categories of CRDTS<a hidden class=anchor aria-hidden=true href=#categories-of-crdts>#</a></h3><p>In <strong>state-based</strong> <em>(passive)</em> replication, every state-changing operation occurs at the source then the system propagates the modified payload to an arbitrary pair of replicas infinitely often. The CRDTs implementing a state-based approach are named Convergent Replicated Data Type, <strong>CvRDTs</strong>.</p><p>Meanwhile, in <strong>operation-based</strong> <em>(active)</em> replication, the system transmits the state-changing operations in two phases: <code>at-source</code> (local) and <code>downstream</code> (async. in replica) one after the other, and both of them must execute atomically. The CRDTs implementing an operation-based strategy are named Commutative Replicated Data Type, <strong>CmRDTs</strong>.</p><p>Now, let&rsquo;s have a quick grasp of one of the basic CvRDTs next.</p><h2 id=building-basic-crdts>Building basic CRDTs<a hidden class=anchor aria-hidden=true href=#building-basic-crdts>#</a></h2><h3 id=counters>Counters<a hidden class=anchor aria-hidden=true href=#counters>#</a></h3><p>The most basic of the CRDTs, a primitive that lives within the replicas exposing a set of basic operations:</p><ul><li><strong>Increment/decrement</strong> the value of the counter.</li><li><strong>Update</strong> the value of the counter.</li><li><strong>Query</strong> the value of the counter.</li></ul><p>The value of the primitive must converge towards the global number of increments minus the number of decrements. These are some of the defined CRDTs counters <sup id=fnref2:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><ul><li>Grow-only Counter (G-Counter): state-based counter for positive increments only.</li><li>Positive-Negative Counter (PN-Counter): state-based counter with a double registry for positive and negative increments.</li><li>Non-negative Counter: similar to PN-Counter with the restriction of not beign able to generate more decrements than the current originated increments.</li></ul><p>To provide a more thorough view of one the counters mentioned above, we picked G-Counter to further explain its operations.</p><h3 id=grow-only-counter-g-counter>Grow-only Counter (G-Counter)<a hidden class=anchor aria-hidden=true href=#grow-only-counter-g-counter>#</a></h3><p>G-Counter is a state-based CRDT or CvRDT for positive increments only. As mentioned above it exposes a set of basic operations: <em>init, increment, value, merge and compare.</em> <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p><img alt="G-COunter OPs 1" loading=lazy src=/images/excalidraws/g-counter-ops-pt1.png>
b). G-Counter OPS: init, increment and value.</p><p><img alt="G-COunter OPs 2" loading=lazy src=/images/excalidraws/g-counter-ops-pt2.png>
c). G-Counter OPS: merge and compare.</p><p>To further visualize a GCounter, we can easily create a class named <code>GCounter</code> that operates with <em>integers</em> and implements each of the methods explained above.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>com.squaredcow.crdts</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>lombok.Data</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Arrays</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>class</span> <span class=nc>GCounter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Counter</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>registryId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>registrySize</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=o>[]</span><span class=w> </span><span class=n>innerRegistry</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>GCounter</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>registryId</span><span class=p>,</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>registrySize</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>registryId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>registryId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>registrySize</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>registrySize</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>innerRegistry</span><span class=w> </span><span class=o>=</span><span class=w>  </span><span class=k>new</span><span class=w> </span><span class=n>Integer</span><span class=o>[</span><span class=n>registrySize</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>GCounter</span><span class=w> </span><span class=nf>init</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Arrays</span><span class=p>.</span><span class=na>fill</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=na>innerRegistry</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>this</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>GCounter</span><span class=w> </span><span class=nf>increment</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>registryId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>innerRegistry</span><span class=o>[</span><span class=n>id</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>innerRegistry</span><span class=o>[</span><span class=n>id</span><span class=o>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>this</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=nf>value</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Integer</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>counter</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>innerRegistry</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>result</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>counter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>result</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Boolean</span><span class=w> </span><span class=nf>compare</span><span class=p>(</span><span class=n>GCounter</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>GCounter</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>x</span><span class=p>.</span><span class=na>getInnerRegistry</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=na>getInnerRegistry</span><span class=p>()</span><span class=o>[</span><span class=n>n</span><span class=o>]</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>y</span><span class=p>.</span><span class=na>getInnerRegistry</span><span class=p>()</span><span class=o>[</span><span class=n>n</span><span class=o>]</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Integer</span><span class=o>[]</span><span class=w> </span><span class=nf>merge</span><span class=p>(</span><span class=n>GCounter</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>GCounter</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Integer</span><span class=o>[]</span><span class=w> </span><span class=n>mergedRegistry</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Integer</span><span class=o>[</span><span class=n>registrySize</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>x</span><span class=p>.</span><span class=na>getInnerRegistry</span><span class=p>().</span><span class=na>length</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Integer</span><span class=w> </span><span class=n>vx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=p>.</span><span class=na>getInnerRegistry</span><span class=p>()</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Integer</span><span class=w> </span><span class=n>vy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>y</span><span class=p>.</span><span class=na>getInnerRegistry</span><span class=p>()</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>mergedRegistry</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>max</span><span class=p>(</span><span class=n>vx</span><span class=p>,</span><span class=w> </span><span class=n>vy</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>mergedRegistry</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>d). GCounter implementation in Java</p><h2 id=closing-words-and-next-steps>Closing words and next-steps<a hidden class=anchor aria-hidden=true href=#closing-words-and-next-steps>#</a></h2><p>This is an initial dive into the CRDTs structures themselves, we will eventually go deeper to construct a cluster of replicas that operate with them. We still need to go first through the rest of the structures mentioned, such as: <em>registers, sets and graphs</em>, but let&rsquo;s have those on a second entry on this blog series.</p><p>With nothing left to add, thank you for reading all the way through, until next time.</p><p>&ndash; squaredcow</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://hal.inria.fr/inria-00555588/document>https://hal.inria.fr/inria-00555588/document</a> Shapiro, Marc; Preguiça, Nuno; Baquero, Carlos; Zawirski, Marek (13 January 2011). &ldquo;A Comprehensive Study of Convergent and Commutative Replicated Data Types&rdquo;. Rr-7506.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type>https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type</a> Section: Known CRDTs&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://squaredcow.dev/tags/distributed-systems/>Distributed Systems</a></li><li><a href=https://squaredcow.dev/tags/crdts/>CRDTs</a></li><li><a href=https://squaredcow.dev/tags/collaborative-editing/>Collaborative Editing</a></li><li><a href=https://squaredcow.dev/tags/technical-interview/>Technical Interview</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on x" href="https://x.com/intent/tweet/?text=CRDTs%20for%20Collaborative%20Writing&amp;url=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f&amp;hashtags=distributedsystems%2cCRDTs%2ccollaborativeediting%2ctechnicalinterview"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f&amp;title=CRDTs%20for%20Collaborative%20Writing&amp;summary=CRDTs%20for%20Collaborative%20Writing&amp;source=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f&title=CRDTs%20for%20Collaborative%20Writing"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on whatsapp" href="https://api.whatsapp.com/send?text=CRDTs%20for%20Collaborative%20Writing%20-%20https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on telegram" href="https://telegram.me/share/url?text=CRDTs%20for%20Collaborative%20Writing&amp;url=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CRDTs for Collaborative Writing on ycombinator" href="https://news.ycombinator.com/submitlink?t=CRDTs%20for%20Collaborative%20Writing&u=https%3a%2f%2fsquaredcow.dev%2fposts%2faxyghjet%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>© Luis Vaca</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>